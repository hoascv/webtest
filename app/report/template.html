
<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="stylesheet" href="css/style.css">
    <meta charset="UTF-8">
    <title>Title</title>
    <h1>{{ data.report }} </h1>
    <h4>Generated at: {{ date }}  Duration: {{finish}} segs  </h4>

</head>
{% macro increment(dct, key, inc=1)%}
    {% if dct.update({key: dct[key] + inc}) %} {% endif %}
    {% if dct.update({'total': dct['total'] + inc}) %} {% endif %}

{% endmacro %}






<body>
{% set requests = { 'service': 0, 'service_values':[] , 'vsu_health': 0, 'vsu_health_values':[] , 'dats_health':0, 'dats_health_values':[] ,'total':0 }    %}
{% for index in range(size) %}
    {% if index == 0 %}
        <table id="table1" class="container">
             <thead>
                <tr>
                    <th>Feature service</th>
                    <th>Cont-Lenght</th>
                    <th>Response time (ms)</th>
                    <th>Status code</th>
                    <th>Request id</th>
                    <th>Server message</th>
                </tr>
            </thead>

            <tbody>
            {% for row in data['service'][index]['content'] %}
            {{ increment(requests, 'service') }}
            {{ requests['service_values'].append(row.time) }}
                <tr>
                  <td>{{ row.service }}</td>
                  <td>{{row.size}}</td>
                  <td>{{ row.time }} </td>
                  <td>{{row.status_code}}</td>
                  <td> {{row.request_id}}</td>
                  <td>{{ row.message[0:30] }}</td>
                </tr>
            {% endfor %}

             </tbody>
      </table>
        <br>
    {% endif %}
    {% if index == 1 %}
        <table id="table2" class="container">
             <thead>
                <tr>
                    <th>Health service (VSU)</th>
                    <th>Cont-Lenght</th>
                    <th>Response time (ms)</th>
                    <th>Status code</th>
                     <th>Request id</th>
                    <th>Server message</th>
                </tr>
            </thead>

            <tbody>

            {% for row in data['service'][index]['content'] %}
            {{ increment(requests, 'vsu_health') }}
            {{ requests['vsu_health_values'].append(row.time) }}
                <tr>
                  <td>{{row.service}} </td>
                  <td>{{row.size}}</td>
                  <td>{{ row.time }}</td>
                  <td>{{row.status_code}}</td>
                  <td> {{row.request_id}}</td>
                  <td>{{ row.message[0:30] }}</td>
                </tr>
            {% endfor %}

             </tbody>
      </table>
    {% endif %}
    {% if index == 2 %}
        <table id="table3" class="container">
             <thead>
                <tr>
                    <th>Health Service (DATS)</th>
                    <th>Cont-Lenght</th>

                    <th>Response time (ms)</th>
                    <th>Status code</th>
                     <th>Request id</th>
                    <th>Server message</th>
                </tr>
            </thead>

            <tbody>
            {% for row in data['service'][index]['content'] %}
             {{ increment(requests, 'dats_health') }}
            {{ requests['dats_health_values'].append(row.time) }}
                <tr>
                  <td>{{ row.service }}</td>
                  <td>{{row.size}}</td>
                  <td>{{ row.time }}</td>
                  <td>{{row.status_code}}</td>
                    <td> {{row.request_id}}</td>
                  <td>{{ row.message[0:30] }}</td>
                </tr>
            {% endfor %}

             </tbody>
      </table>
    {% endif %}


{% endfor %}

<h3>
    Total Request: {{ requests['total'] }}

</h3>
<h4>
    <p> Feature Service : {{ requests['service'] }} requests  Max: {{requests['service_values']| max }} ms  {{requests['service_values'][0]}}  Min: {{requests['service_values']| min }} ms
        AVG: {{( requests['service_values']| sum ) /(requests['service_values']| length)|round}} ms </p>
    <p> VSU Health Service : {{ requests['vsu_health'] }} Max: {{requests['vsu_health_values']| max }} {{requests['vsu_health_values'][0]}}  Min: {{requests['vsu_service_values']| min }}
        AVG: {{( requests['vsu_health_values']| sum ) /(requests['vsu_health_values']| length)|round}} </p>

    <p> DATS Health Service : {{ requests['dats_health'] }} Max: {{requests['dats_health_values']| max }} {{requests['dats_health_values'][0]}}  Min: {{requests['dats_service_values']| min }}
        AVG: {{( requests['dats_health_values']| sum ) /(requests['dats_health_values']| length)|round}} </p>

</h4>

</body>
</html>
